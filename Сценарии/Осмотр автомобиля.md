### Осмотр автомобиля
**1. Получение информации о предыдущем осмотре**
1.1. Пользователь вводит идентификатор автомобиля (сканирует ШК или вводит гос-номер).
1.2. Приложение делает запрос на информацию об автомобиле в **API GateWay**, который шлюз транслирует в серис **Хронологии автомобилей**.
1.3. Сервис находит информацию о последнем результате осмотра и возвращает информацию в клиентское приложение, при этом если в результате осмотра есть файлы фотографий, 
то передаются их идентификаторы.
1.4. Получив информацию о предыдущем осмотре автомобиля приложение запускает в фоне задачи на получение фотографий по их идентификаторам, полученные на этапе 3. 
1.5. Фоновые задачи оптравляют запросы к **Хранилищу файлов к документам** передавая идентификатор документов, которых нет в локальном кэше приложения, 
по завершению загрузки обновляется информация на форме с результатами осомотра. 
1.6. Полученные фотографии сохраняются в локальных кэш приложения, чтобы не загружать их повторно.
1.7. Модель данных инциализируется из полученного состония от сервиса.

**2. Проведение осмотра**
2.1. Пользователь выполняет осмотр автомобиля отмечая обязательные поля из чек листа (наличие огнетушителя, наличие колес, марка шин и т.п.)
2.2. Пользователь удаляет те инциденты, которые были устранены - отсутвуют на текущей момент и (или) добавляет новые. 
При добавлении нового инцидента пользователь создает фотографии инцидентов. При этом приложение генерирует идентификаторы их фотографий, 
а в модель данных добавляет ссылки, на созданные файлы.
2.3. Пользователь нажимает **Сохранить осмотр автомобиля** - приложение делает запрос на создание факта осмотра автомобиля, отправляя его в **API GateWay**, 
где сообщение помещается в **Шину сообщений**. 
2.4. Сервис **Хронологии автомобилий** перехватывает сообщение с фактом осмотра автомобиля, сохраняя данные в своем хранилище, 
а так же публикует уведомление для **Шлюза 1С**, о том что произошел факт осмотра автомобиля.
2.5. **Шлюз 1С** перехватывает сообщение о факте осмотра авто и заносит изменения в карточку автомобиля и генерирует документы в базе 1С.
2.6. Для фотографий приложение создает фоновые задачи, которые отправляют данные в виде контента, идентификатора файла в **API GateWay**, 
который создает сообщения в **Шину сообщений**
2.7. **Хранилище файлов к документам** перехватывает сообщения с файлами и сохраняет их в хранилище.
