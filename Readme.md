## ATOMAN 
### Приложение автотранспортного отдела Экспресс доставки

Приложение предназначено для учета состояния автомобилей отдела автотранспортного отдела (далее АТО) Экспресс доставки. 
Основные выполняемые задачи:
1. Осущетвление закрепления автомобиля за водителем на момент передачи в эксплуатации закреплением информации в виде акта передачи.
2. Фиксация состояния автомобиля при передаче автомобиля от механия водителю и обратно, от механика в сервисный центр и обртано, от водителя водителю.
3. Фиксация повреждения автомобиля на момент передачи в виде инцидентов с фотографиями и местами повреждения.
4. Просмотр хронологии повреждений и перемещения автомобиля между эксплуатирующими лицами.

Общая схема взаимодействия сервисов представлена ниже.
![Схема взаимеодейсвия сервисов Автотранспортного отдела](https://user-images.githubusercontent.com/60660331/184500954-84e04c79-8a9b-4d44-ac4b-bc89bfa6684a.png)

## Сервисы и элементы системы
### 1. Шлюз 1С
Основная задача севрвиса - синхронизация данных о сотрудниках и автомобилях с БД 1С Предприятие. 
Серивис отслеживает изменения в данных по автомобилям и сотрудникам публикуя информацию в **Шину сообщений**, из которой подписанные сервисы: **Сервис пользователей** и **Сервис хронологии по автомобилям** получают информацию, обновляя данные. Шлюз 1С так же подписывается на событие о факте передачи автомобиля от одного сотрудника другому и обновляет информацию в БД 1С Предприятие, а так же формирует требуемые документы.

### 2. Пользователи, полномочия
Основная задача сервиса - хранение кэшированных данных об идентификаторах, ролях и так же основной информации: ФИО, должность и т.п. полученной из 1С, а так же предоставление этой информации при запросе от **API GateWay** на чтение.

### 3. Хронология автомобилей
Основные задачи сервиса: 
- хранение и выдача по запросу фактов передачи автомобилей
- хранение и выдача фактов осмотра автомобилей
- хранение и выдача информации об инцидентах при осмотре автомобиля

Всю новую информацию сирвис получает из **Шины сообщений**, а так же отвечает на запросы от **API GateWay** на чтение хронологии по автомобилям.

### 4.Хранилище файлов к документам
Основная задача сервиса - хранение файлов документов (фотографий), которые пользователи прикладывают во время создания акта передачи или осмотра автомобиля. Файлы приходят в сервис через **Шину сообщений** и возвращаются по запросу от **API GateWay** на чтение.

### 5.Сервис авторизации JWT
Сервис получает от пользовательского приложения штрик-код с кодом пользователя или пару логин + пароль. Если пользователь известен сервис делает запрос в сервис **Пользователей и полномочий** для получения информации о ролях пользователя в системе и пакует полученный ответ в JWT-токен, который сохраняет пользовательское приложение.

### 6.API GateWay
Основные задачи сервиса:
- маршрутизация трафика от приложения к нужным сервисам в зависимости от запроса
- агреггирование информации при запросе информации об инцидентах и актах передачи автомобилей
